<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>–£—á–µ–±–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</title>
    <link rel="stylesheet" href="./style.css?v=4" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo">–£—á–µ–±–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</div>

      <nav class="nav">
        <button class="nav-item active" data-page="home">üè† –ì–ª–∞–≤–Ω–∞—è</button>
        <button class="nav-item" data-page="library">üìö –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</button>
        <button class="nav-item" data-page="workspace">üõ† –†–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ</button>
      </nav>

      <!-- –ü–∞–Ω–µ–ª—å –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
      <div id="libraryPanel" class="panel" style="display: none">
        <h3>–ù–æ–≤–∞—è –∫–æ–ª–æ–¥–∞</h3>
        <input id="deckTitleInput" class="input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" />
        <input
          id="deckDescInput"
          class="input"
          placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"
          style="margin-top: 6px"
        />

        <input id="deckColorInput" class="input" type="color" value="#a855f7" style="margin-top:6px" />
        <input
          id="deckExamInput"
          class="input"
          type="date"
          style="margin-top: 6px"
        />
        <button id="createDeckBtn" class="btn" style="margin-top: 8px">
          + –°–æ–∑–¥–∞—Ç—å
        </button>
      </div>

      <!-- –≠–∫—Å–ø–æ—Ä—Ç/–ò–º–ø–æ—Ä—Ç -->
      <div class="panel">
        <button id="exportBtn" class="btn btn-secondary" style="width: 100%">
          ‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç JSON
        </button>
        <button
          id="importBtn"
          class="btn btn-secondary"
          style="width: 100%; margin-top: 6px"
        >
          ‚¨ÜÔ∏è –ò–º–ø–æ—Ä—Ç JSON
        </button>
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <header class="main-header">
        <div id="deckColorBox" class="row" style="gap:8px; display:none">
          <span class="muted small">–¶–≤–µ—Ç –∫–æ–ª–æ–¥—ã</span>
          <input id="deckColorPicker" type="color" value="#a855f7" style="width:34px;height:28px;padding:0;border:none;background:transparent;cursor:pointer" />
        </div>
        
        <div>
          <div class="deck-title" id="pageTitle">–ì–ª–∞–≤–Ω–∞—è</div>
          <div id="deckExamInfo" class="muted"></div>
        </div>
        <div id="workspaceSwitch" class="mode-switch" style="display: none">
          <button class="mode-btn active" data-mode="manage">
            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
          </button>
          <button class="mode-btn" data-mode="study">–£—á–∏—Ç—å</button>
        </div>
      </header>

      <!-- –ì–ª–∞–≤–Ω–∞—è -->
      <section id="homeSection">
        <div class="hero">
          <h1>–ü–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é üìÖ</h1>
          <p class="muted">
            –ù–∞–∂–∏–º–∞–π –¥–µ–Ω—å, —á—Ç–æ–±—ã —É—á–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–º—ã. ¬´–°–µ–≥–æ–¥–Ω—è¬ª –ø–æ–¥—Å–≤–µ—á–µ–Ω.
          </p>

          <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å (–Ω–µ–¥–µ–ª—è) -->
          <div class="weekbar">
            <button id="prevWeek" class="btn btn-secondary">‚Üê –ù–µ–¥–µ–ª—è</button>
            <div id="weekLabel" class="muted"></div>
            <button id="nextWeek" class="btn btn-secondary">–ù–µ–¥–µ–ª—è ‚Üí</button>
          </div>

          <div id="weekGrid" class="week-grid"></div>

          <div class="hero-actions">
            <button class="btn" data-goto="library">–û—Ç–∫—Ä—ã—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É</button>
            <button class="btn btn-secondary" id="openScheduleGuide">
              –ö–∞–∫ –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ?
            </button>
          </div>
        </div>
      </section>

      <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ -->
      <section id="librarySection" style="display: none">
        <div class="lib-toolbar">
          <input
            id="libSearch"
            class="input"
            placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/–æ–ø–∏—Å–∞–Ω–∏—é..."
          />
        </div>
        <div id="libraryGrid" class="grid"></div>
        <div class="empty-state" id="libraryEmpty" style="display: none">
          –ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–ª–æ–¥. –°–æ–∑–¥–∞–π –ø–µ—Ä–≤—É—é —Å–ª–µ–≤–∞ üëà
        </div>
      </section>

      <!-- –†–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ -->
      <section id="workspaceSection" style="display: none">
        <div class="ws-top-grid">
        <div class="card-form" id="cardEditor">
          <h3>–ù–æ–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞</h3>

          <div class="field" id="frontField" data-img="">
            <textarea
              id="cardFrontInput"
              class="textarea"
              rows="2"
              placeholder="–í–æ–ø—Ä–æ—Å..."
            ></textarea>
            <div class="thumb" id="frontThumb">
              <img alt="front" /><span class="x" data-target="front">√ó</span>
            </div>
            <button type="button" class="icon-btn" id="frontImgBtn">üì∑</button>
            <input
              id="frontImgFile"
              type="file"
              accept="image/*"
              style="display: none"
            />
          </div>
     

          <div class="field" id="backField" data-img="" style="margin-top: 8px">
            <textarea
              id="cardBackInput"
              class="textarea"
              rows="2"
              placeholder="–û—Ç–≤–µ—Ç..."
            ></textarea>
            <div class="thumb" id="backThumb">
              <img alt="back" /><span class="x" data-target="back">√ó</span>
            </div>
            <button type="button" class="icon-btn" id="backImgBtn">üì∑</button>
            <input
              id="backImgFile"
              type="file"
              accept="image/*"
              style="display: none"
            />
          </div>

          <div style="margin-top: 8px">
            <select id="cardTypeSelect" class="input">
              <option value="basic">–û–±—ã—á–Ω–∞—è (–≤–æ–ø—Ä–æ—Å / –æ—Ç–≤–µ—Ç)</option>
              <option value="single">–¢–µ—Å—Ç (–æ–¥–∏–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç)</option>
            </select>
          </div>

          <div style="margin-top: 8px">
            <input
              id="cardTopicInput"
              class="input"
              list="topicsDatalist"
              placeholder="–¢–µ–º–∞ (–Ω–∞–ø—Ä. ¬´–ò–Ω—Ç–µ–≥—Ä–∞–ª—ã¬ª, ¬´–õ–µ–∫—Å–∏–∫–∞¬ª)"
            />
            <datalist id="topicsDatalist"></datalist>
          </div>

          <div id="optionsEditor" style="margin-top: 8px; display: none">
            <div class="row-between" style="margin-bottom: 4px">
              <span class="muted small">–í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞</span>
              <button
                type="button"
                id="addOptionBtn"
                class="btn btn-secondary"
                style="padding: 4px 10px; font-size: 12px"
              >
                + –í–∞—Ä–∏–∞–Ω—Ç
              </button>
            </div>
            <div id="optionsList"></div>
            <p class="muted small" style="margin-top: 4px">
              –î–æ–±–∞–≤—å –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –æ—Ç–º–µ—Ç—å –æ–¥–∏–Ω –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.
            </p>
          </div>

          <div class="row" style="margin-top: 10px">
            <button class="btn" id="saveCardBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button
              class="btn btn-secondary"
              id="cancelEditBtn"
              style="display: none"
            >
              –û—Ç–º–µ–Ω–∏—Ç—å
            </button>
          </div>
        </div>
        <aside id="wsScheduleBox" class="card-form schedule-card" style="display:none">
          <h3 style="margin-bottom:8px">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∫–æ–ª–æ–¥—ã</h3>
    
          <div class="row row-wrap" style="gap:8px; align-items:center;">
            <label class="muted" style="min-width:80px">–î–µ–Ω—å</label>
            <select id="scheduleWeekday" class="input" style="max-width: 160px">
              <option value="0">–ü–Ω</option><option value="1">–í—Ç</option><option value="2">–°—Ä</option>
              <option value="3">–ß—Ç</option><option value="4">–ü—Ç</option><option value="5">–°–±</option><option value="6">–í—Å</option>
            </select>
    
            <label class="muted" style="min-width:80px">–¢–µ–º–∞</label>
            <input id="scheduleTopic" list="topicsDatalist" class="input" placeholder="(–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" style="max-width:260px" />
    
            <button id="scheduleAddBtn" class="btn">+ –î–æ–±–∞–≤–∏—Ç—å</button>
          </div>
    
          <div id="scheduleList" style="margin-top:10px"></div>
        </aside>
      </div>
    </div>

        <div class="card-list" id="cardTable">
          <div class="search-bar row-wrap">
            <input
              class="input"
              id="searchInput"
              placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏–ª–∏ –æ—Ç–≤–µ—Ç–∞–º..."
              style="flex: 1; min-width: 220px"
            />
            <select class="input" id="topicFilter" style="max-width: 220px">
              <option value="">–í—Å–µ —Ç–µ–º—ã</option>
            </select>
          </div>

          <table>
            <thead>
              <tr>
                <th>–í–æ–ø—Ä–æ—Å</th>
                <th>–û—Ç–≤–µ—Ç</th>
                <th>–¢–µ–º–∞</th>
                <th>–ò–Ω—Ç–µ—Ä–≤–∞–ª</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div class="empty-state">–î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É üëÜ</div>
        </div>

        <div id="studySection" style="display: none">
          <div class="study-card">
            <div class="study-card-inner">
              <div class="study-label">–í–æ–ø—Ä–æ—Å</div>
              <div class="study-text">–í—ã–±–µ—Ä–∏ –∫–æ–ª–æ–¥—É –∏ –Ω–∞–∂–º–∏ ¬´–£—á–∏—Ç—å¬ª.</div>
              <div id="optionsContainer" class="option-list"></div>
            </div>
            <div class="study-actions"></div>
          </div>
        </div>
      </section>
    </main>

    <div class="toast-container" id="toastContainer"></div>

    <script defer src="./app.js"></script>
  </body>
</html>
